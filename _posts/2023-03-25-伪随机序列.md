---
layout: post
title:  "伪随机序列"
author: "Geoffrey Hou"
comments: true
tags: NR
excerpt_separator: <!--more-->
sticky: true
hidden: true
---

<head>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: {
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
            inlineMath: [['$','$']]
            }
        });
    </script>
</head>

关于LTE/NR中的伪随机序列，算法设计上有些考虑。<!--more-->

## 协议中的定义
3gpp中对伪随机序列的定义为:

Generic pseudo-random sequences are defined by a length-31 Gold sequence. The output sequence $c(n)$ of length $M_{\mathrm{PN}}$, $n=0,1, \ldots, M_{\mathrm{PN}}-1$ , is defined by 
<center>$c(n)=\left(x_1\left(n+N_C\right)+x_2\left(n+N_C\right)\right) \bmod 2$</center>
<center>$x_1(n+31)=\left(x_1(n+3)+x_1(n)\right) \bmod 2$</center>
<center>$x_2(n+31)=\left(x_2(n+3)+x_2(n+2)+x_2(n+1)+x_2(n)\right) \bmod 2$</center>
<center>$N_{\mathrm{C}}=1600$</center>

the first m-sequence $x_1(n)$ shall be initialized with $x_1(0)=1, x_1(n)=0, n=1,2, \ldots, 30$. The initialization of the second m-sequence $x_2(n)$, is denoted by $c_{\text {init }}=\sum_{i=0}^{30} x_2(i) \cdot 2^i$ with the value depending on the application of the sequence.

可以看出，伪随机序列$c(n)$是通过两个m序列$x_1(n+31)$和$x_2(n+31)$模2加得到，并且这两个m序列从偏移1600的位置开始。这两个m序列可以通过级数31的LFSR的31bit当前状态更新得到后面的状态。

## LSFR
用$\boldsymbol{y}(n)=[y(n), y(n+1), \ldots, y(n+30)]$表示初始状态，那么LSFR经过$k$次循环移位后的状态$\boldsymbol{y}(n+k)=[y(n+k), y(n+1+k), \ldots, y(n+30+k)]$可以通过下面公式得到：
<center>$[\boldsymbol{y}(n+k)]^T=\boldsymbol{H}^t \cdot[\boldsymbol{y}(n)]^T$</center>
$\boldsymbol{H}$由LFSR的结构决定，以$x_2(n+31)$为例，$\boldsymbol{H}$的维度是$31 \times 31$：

$$
\begin{bmatrix}
1 & 2 & 3 \\
4 & 5 & 6 \\
7 & 8 & 9
\end{bmatrix} \tag{2}
$$

## Download or Contribute
Tale is publicly hosted on GitHub, so go ahead and download or fork it at the [GitHub repository](https://github.com/chesterhow/tale). If you spot any bugs or have any suggestions, feel free to create an issue or make a pull request.

Thanks for checking out Tale!
